<html>
	<head>
		<title>Your Web App Is Insecure and It's Your Fault -- Jon Canady (dot com)</title>
		<link rel="stylesheet" href="/stylesheets/style.css" type="text/css" />
		<link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" />
		<link rel="alternate" type="application/atom+xml" href="/atom.xml">
	</head>
	<body>
		<div id="header">
	<h1>Jon Canady</h1>
	<ul>
		<li><a href="/">About</a></li>
		<li><a href="/articles/">Bloggery</a></li>
		<li><a href="http://github.com/joncanady">Projects</a></li>
	</ul>
</div>
		<div id="content">
			<h1>Your Web App Is Insecure and It's Your Fault</h1>
			<h2>Jan 27, 2009</h2>
			
			
			
			<div id="alert">
				<p>This is an older post imported from my previous Wordpress blog. If you
				find any errors, <a href="mailto:jon@joncanady.com">let me 
				know</a>.</p>
			</div>
			
			
			
			<p>Ask any web app coder what their biggest security concerns are and you'll probably get a list that includes one or more of:</p>

<ul>
<li>Cross Site Scripting (XSS)</li>
<li>Injection flaws (e.g. SQL Injection)</li>
<li>Malicious File Execution</li>
<li>Insecure Object Reference (e.g. <a href="http://www.php.net/register_globals">register_globals</a> retardation)</li>
<li>Cross Site Request Forgery (CSRF)</li>
<li>Improper Error Handling / Information Leakage (stack traces on production sites)</li>
<li>Broken Auth / Session Management (Session Hijacking)</li>
</ul>


<p>That's actually the top seven from the <a href="http://www.owasp.org/index.php/Top_10_2007">OWASP Top 10</a> (from 2007), by the way.<br/>
</p>

<p>The thing is that while some of these issues are little funkier, the top two can be <em>completely fixed</em> by simply following The Rules.<br/>
</p>

<h2>Rule 1</h2>

<blockquote><p>When putting anything in the database, unless it's hardcoded in the application, assume it's malicious and encode it.</p></blockquote>

<p>If you're working with SQL databases, <a href="http://www.google.com/search?q=bind+parameters&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">bound parameters</a> are your friend.  If for some reason that's not an option, your database library <em>absolutely has</em> a call to encode any potentially dangerous input.  Even if you're working in base PHP, <a href="http://php.net/mysql_real_escape_string"><code>mysql_real_escape_string()</code></a> is available.</p>

<p>Also, don't think that just because you know <em>where</em> the data's coming from that it's safe.  You <em>will be wrong</em>, and it's much better to be wrong halfway through development and fix it than it is six months after production.</p>

<h2>Rule 2</h2>

<blockquote><p>When outputting anything, encode it as appropriate for the output medium.</p></blockquote>

<p>In most web applications, you're outputting to an HTML document.  So be certain that if you're grabbing a chunk of text from the database that you're encoding it as HTML.  Base PHP provides <a href="http://php.net/htmlentities"><code>htmlentities()</code></a>, other languages/frameworks have better solutions: Rails' <a href="http://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html">sanitize</a> helper.  These things make sure that the <code>&lt;script&gt;</code> tag I put in your database won't actually <em>run</em>.</p>

<p>If you <em>absolutely must</em> let user-provided HTML through then <em>for goodness' sake</em> scrub the hell out of it!  If you need to let people use <code>&lt;b&gt;</code> and <code>&lt;i&gt;</code> tags, <em>only let those through</em>!  Just because you need <em>some</em> HTML doesn't mean you need <em>all</em> of it.</p>

<p>This applies equally to other forms of output: if you're writing to a logfile, strip out things like <code>bash</code> control characters or tabs/newlines.  <a href="http://www.owasp.org/index.php/Log_injection">Attackers are smart</a>, they'll think of things you won't.</p>


			<div>
				
				<span>
					<a rel="prev" href="/2009/01/27/linkedin-security-fail/" 
					title="View LinkedIn Security Fail"
					>&larr; Previous: LinkedIn Security Fail</a>
				</span>
				
				<br />
				
				<span>
					<a rel="next" href="/2009/01/28/dear-columbus-ohio-motorists-2/" 
					title="View Dear Columbus Ohio Motorists"
					>Next: Dear Columbus Ohio Motorists &rarr;</a>
				</span>
				
			</div> 

			<div id="footer">
	<p>Powered by <a href="http://github.com/mojombo/jekyll">Jekyll</a>; your visit consumed no database resources, and didn't need parsing. Isn't that awesome?</p>
	<p>Blog post text is covered by this <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/us/">Creative Commons</a> license, everything else is mine.</p>
</div>

		</div>
	</body>
</html>